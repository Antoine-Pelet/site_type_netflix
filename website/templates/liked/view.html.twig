{% extends 'base.html.twig' %}

{% block title %}
	Series index
{% endblock %}

{% block stylesheets %}
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="{{ asset('style.css') }}" rel="stylesheet"/>
	<link href="{{ asset('styleSeries.css') }}" rel="stylesheet"/>
{% endblock %}

{% block body %}

	<div class="listeseries">
		{% for s in seriesView %}
			<table class="tableau">
				<tr>
					<td><a href="{{ path('app_series_show', {'id': s.id}) }}"><img src="{{ path('app_series_poster', {'id': s.id}) }}"></a></td>
					<td>{{ s.title }}</td>
					{% set cpt = 1 %}
					{% for seas in seasons|sort((a, b) => a.number <=> b.number) %}
						{% if seas.series.id == s.id %}
							<td>
							<div id="accordion">
							<div class="card bg-transparent">
								<div class="card-header">
									<a class="card-link" data-toggle="collapse" href="#collapse{{cpt}}{{s.id}}">Saison{{seas.number}}</a>
								</div>
								{% for epi in episodes|sort((a, b) => a.number <=> b.number) %}
										{% if epi.season.id == seas.id %}
											<div id="collapse{{cpt}}{{s.id}}" class="collapse" data-parent="#accordion">
												<div class="card-body border">
													<p>{{ epi.title }} ( Episode :{{ epi.number }} )
														<a href="{{ path('app_series_vu', {'id': epi.id, 'season_number': seas.number, 'epi_number': epi.number}) }}">visionné !</a>
													</p>
												</div>
											</div>
										{% endif %}
								{% endfor %}
								{% set cpt = cpt + 1 %}
								</div>
							</div>
							</td>
						{% endif %}
					{% endfor %}
				</tr>
			</table>
		{% else %}
			<p>Aucune série n cours de visionnage</p>
		{% endfor %}
	</div>
{% endblock %}
